<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>AR Touch Rotation</title>

<script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
<script src="https://cdn.jsdelivr.net/npm/aframe-gesture-detector@3.3.0/dist/aframe-gesture-detector.min.js"></script>

<style>
  body, html { margin: 0; padding: 0; overflow: hidden; }
</style>

<script>
AFRAME.registerComponent('touch-rotate', {
  schema: { speed: { default: 2 } },
  init: function () {
    const el = this.el;
    let rotation = el.getAttribute('rotation');

    el.sceneEl.addEventListener('onefingermove', e => {
      // Solo girar si el modelo est√° visible y detectado
      if (!el.object3D.visible) return;
      rotation.y += e.detail.positionChange.x * this.data.speed;
      el.setAttribute('rotation', rotation);
    });
  }
});
</script>

</head>
<body>

<a-scene
  embedded
  arjs="sourceType: webcam; debugUIEnabled: false;"
  gesture-detector
>
  
  <!-- RAYCASTER para detectar el modelo -->
  <a-entity camera>
    <a-entity cursor="fuse: false;"
              raycaster="objects: .clickable">
    </a-entity>
  </a-entity>

  <a-assets>
    <a-asset-item id="naturaleza" src="modelos/Naturaleza.glb"></a-asset-item>
  </a-assets>

  <a-marker type="pattern" url="markers/nature.patt">
    <a-entity class="clickable"
              gltf-model="#naturaleza"
              scale="0.5 0.5 0.5"
              position="0 0 0"
              rotation="0 0 0"
              touch-rotate="speed:2">
    </a-entity>
  </a-marker>

</a-scene>

</body>
</html>
