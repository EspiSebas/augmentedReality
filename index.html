<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>AR Rotación Touch</title>

  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

  <!-- Detector de gestos para móviles -->
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-gesture-detector@3.3.0/dist/aframe-gesture-detector.min.js"></script>

  <style>
    body, html { margin: 0; padding: 0; overflow: hidden; }
  </style>
</head>

<body>
<script>
  // componente para rotar el modelo con el dedo
  AFRAME.registerComponent('rotate-on-gesture', {
    schema: { speed: {default: 1} },
    init: function () {
      const el = this.el;
      this.handleRotation = this.handleRotation.bind(this);
      el.sceneEl.addEventListener('onefingermove', this.handleRotation);
    },
    handleRotation: function (event) {
      const rotation = this.el.getAttribute('rotation');
      rotation.y += event.detail.positionChange.x * this.data.speed;
      this.el.setAttribute('rotation', rotation);
    }
  });
</script>

<a-scene embedded vr-mode-ui="enabled: false" gesture-detector arjs="sourceType: webcam; debugUIEnabled: false;">
  <a-assets>
    <a-asset-item id="naturaleza" src="modelos/Naturaleza.glb"></a-asset-item>
    <a-asset-item id="lumira" src="modelos/lumira.glb"></a-asset-item>
  </a-assets>

  <!-- Luces -->
  <a-entity light="type: ambient; color: #fff; intensity: 1.2"></a-entity>
  <a-entity light="type: directional; color: #fff; intensity: 3" position="2 4 2"></a-entity>

  <!-- Modelo con rotación táctil -->
  <a-marker type="pattern" url="markers/nature.patt">
    <a-entity gltf-model="#naturaleza" scale="0.5 0.5 0.5" position="0 0 0" rotation="90 180 0"
              rotate-on-gesture="speed:1.5"></a-entity>
  </a-marker>

  <!-- Segundo modelo también rotatable -->
  <a-marker type="pattern" url="markers/sunlight.patt">
    <a-entity gltf-model="#lumira" scale="0.5 0.5 0.5" position="0 0 0" rotation="90 90 0"
              rotate-on-gesture="speed:1.5"></a-entity>
  </a-marker>

  <a-entity camera></a-entity>
</a-scene>

</body>
</html>
